<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Minifb WebAssembly example</title>
	</head>
	<body>
		<script>
			if (!('WebAssembly' in window)) {
				alert("Your browser doesn't support Web Assembly. You may need to enable it in your browser's flags.");
			}

			fetch('../target/wasm32-unknown-unknown/debug/minifb.wasm').then(response =>
				response.arrayBuffer()
			).then(bytes =>
				WebAssembly.instantiate(bytes, { env: imports() })
			).then(results => {
				let module = {};
				let mod = results.instance;
				module.alloc = mod.exports.alloc;
				module.dealloc = mod.exports.dealloc;
				module.draw = mod.exports.draw;

				var width = 320;
				var height = 200;

				let byteSize = width * height * 4;
				var pointer = module.alloc(byteSize);
				var buffer = new Uint8Array(mod.exports.memory.buffer, pointer, byteSize);
			});
		</script>

		<input type="button" id="btn" value="Click me to execute hello world!" />
	</body>
</html>
